<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Select Terminal & Academic Year</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#1a3a52 0%,#0f1f2e 100%);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    
    .container{max-width:600px;width:100%;background:rgba(255,255,255,.98);border-radius:20px;padding:50px 40px;box-shadow:0 20px 60px rgba(0,0,0,.3);position:relative;overflow:hidden}
    .container::before{content:'';position:absolute;top:0;left:0;width:100%;height:6px;background:linear-gradient(90deg,#ff8c42 0%,#e67a2e 100%)}
    
    .header{text-align:center;margin-bottom:40px}
    .icon-wrapper{width:80px;height:80px;background:linear-gradient(135deg,#ff8c42 0%,#e67a2e 100%);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;box-shadow:0 8px 20px rgba(255,140,66,.3)}
    .icon-wrapper svg{width:40px;height:40px;color:#fff}
    .title{font-size:28px;font-weight:800;color:#1a3a52;margin-bottom:8px;letter-spacing:.5px}
    .subtitle{font-size:15px;color:#64748b;font-weight:400}
    
    .form-group{margin-bottom:28px}
    .form-label{display:block;font-size:14px;font-weight:700;color:#1a3a52;margin-bottom:10px;text-transform:uppercase;letter-spacing:.5px}
    
    select{width:100%;padding:16px 20px;border:2px solid #e1e8ed;border-radius:12px;font-size:15px;color:#1a3a52;background:#fff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23ff8c42' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E") no-repeat right 16px center/20px;padding-right:50px;transition:all .2s;cursor:pointer;appearance:none;font-weight:600}
    select:hover{border-color:#ff8c42;background-color:#fff9f5}
    select:focus{outline:0;border-color:#ff8c42;box-shadow:0 0 0 4px rgba(255,140,66,.1);background-color:#fff}
    select option{padding:12px;font-weight:600}
    
    .info-box{background:linear-gradient(135deg,#f0f9ff 0%,#e0f2fe 100%);border-left:4px solid #ff8c42;padding:16px 20px;border-radius:8px;margin-top:30px}
    .info-box-title{font-size:13px;font-weight:700;color:#1a3a52;margin-bottom:6px;display:flex;align-items:center;gap:8px}
    .info-box-title svg{width:18px;height:18px;color:#ff8c42}
    .info-box-text{font-size:12px;color:#475569;line-height:1.6}
    
    .loading{display:none;text-align:center;margin-top:20px}
    .loading.active{display:block}
    .spinner{width:40px;height:40px;border:4px solid #e1e8ed;border-top-color:#ff8c42;border-radius:50%;animation:spin 0.8s linear infinite;margin:0 auto 12px}
    .loading-text{font-size:14px;color:#64748b;font-weight:600}
    
    @keyframes spin{
      to{transform:rotate(360deg)}
    }
    
    @media(max-width:768px){
      .container{padding:40px 30px}
      .title{font-size:24px}
      .subtitle{font-size:14px}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="icon-wrapper">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
      </div>
      <h1 class="title">Exam Routine Selection</h1>
      <p class="subtitle">Choose terminal and academic year to view exam schedule</p>
    </div>
    
    <div class="form-group">
      <label class="form-label" for="terminal">
        <svg style="width:14px;height:14px;display:inline;vertical-align:middle;margin-right:4px" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
        </svg>
        Terminal
      </label>
      <select name="terminals" id="terminal">
        <option value="" selected disabled>Select Terminal Period</option>
        <% marksheetSetups[0].terminals.forEach((terminal)=>{%>
          <option value="<%=terminal.name%>"><%=terminal.name%></option>
        <% }) %>
      </select>
    </div>
    
    <div class="form-group">
      <label class="form-label" for="academicYear">
        <svg style="width:14px;height:14px;display:inline;vertical-align:middle;margin-right:4px" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
        Academic Year
      </label>
      <select name="academicYear" id="academicYear">
        <option value="" selected disabled>Select Academic Year</option>
        <% currentYear = Number(marksheetSetups[0].academicYear) %>;
        <% for (let i = 0; i < 5; i++) { %>
          <option value="<%= currentYear - i %>"><%= currentYear - i %></option>
        <% } %>
      </select>
    </div>
    
    <div class="loading" id="loading">
      <div class="spinner"></div>
      <div class="loading-text">Loading exam routine...</div>
    </div>
    
    <div class="info-box">
      <div class="info-box-title">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        Information
      </div>
      <p class="info-box-text">Please select both terminal and academic year. The exam routine will be displayed automatically once both selections are made.</p>
    </div>
  </div>

  <script>
    const terminalSelect = document.getElementById('terminal');
    const yearSelect = document.getElementById('academicYear');
    const loading = document.getElementById('loading');

    function redirectIfReady() {
      const terminal = terminalSelect.value;
      const year = yearSelect.value;

      if (terminal && year) {
        loading.classList.add('active');
        setTimeout(() => {
          window.location.href = `/examroutine?terminal=${terminal}&academicYear=${year}`;
        }, 300);
      }
    }

    terminalSelect.addEventListener('change', redirectIfReady);
    yearSelect.addEventListener('change', redirectIfReady);
  </script>
</body>
</html>